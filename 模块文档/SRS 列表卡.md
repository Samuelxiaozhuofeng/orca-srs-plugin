# SRS 列表卡

## 功能概述

“列表卡”用于把一个列表按条目顺序逐条推送复习，每个条目都有独立的记忆评分与调度。

核心规则：
- 条目来源只取父块的**直接子块**（children）。
- **Good / Easy** 才会解锁并继续推送下一条（正式复习）。
- 若某条评分为 **Again / Hard**：
  - 后续条目会在正式调度上被安排到**明天**再推送；
  - 但当日仍会继续展示后续条目作为**辅助预览**，其评分**不计入统计**，也**不会更新记忆状态**。

## 创建方式

在编辑器中将列表写为“父块 + 多个子块条目”，然后：
- 通过斜杠命令：`创建列表卡（子块作为条目）`

创建后父块会带上标签：
- `#card(type=list)`

## 数据结构与存储

### 父块（列表卡容器）

- 负责结构与渲染：`#card(type=list)`
- 条目顺序以 `children` 当前顺序为准

### 子块（条目卡）

- 每个条目子块自身存储普通卡的 SRS 属性：`srs.*`
- 这样可以保证“条目身份”稳定：
  - 编辑条目文本不会丢进度
  - 重排子块顺序不会导致进度错位
  - 新增子块视为新条目（新卡）

### 初始化规则

创建列表卡时：
- 第 1 条默认“今天到期”
- 其余条目默认“明天到期”（需要通过 Good/Easy 逐次解锁）

## 复习行为

### 正式复习

复习队列会为每张列表卡选择一个“正式可复习条目”：
- 按当前条目顺序从前到后查找第一个 `due <= now` 的条目

评分行为：
- **Good / Easy**：解锁下一条，将其 `due` 调整为“现在”，并加入本次会话队列
- **Again / Hard**：
  - 将后续条目中 `due < 明天零点` 的条目统一推迟到“明天零点”
  - 同时把后续条目加入本次会话作为“辅助预览”

### 辅助预览

- 允许评分（便于自我反馈）
- 但评分不会：
  - 写入复习日志
  - 更新条目的 SRS 状态
  - 计入任何正式统计

复习界面会显示明确提示：“辅助预览，不计入统计”。

## 常见问题

### 重排条目会怎么样？

条目进度跟随子块 `blockId`，重排只会改变“下一条要推送的顺序”，不会重置已存在的条目进度。

### 删除/新增条目会怎么样？

- 删除子块：对应条目不再存在
- 新增子块：视为新条目（新卡），将按初始化规则进入解锁流程

